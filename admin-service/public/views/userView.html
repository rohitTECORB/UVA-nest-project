<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Admin | Eppy</title>
    <link rel="stylesheet" href="paginate/bs-pagination.min.css">
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="paginate/pagination.min.js"></script>

    <!--<link rel="stylesheet" href="dist/pagination.min.css">-->
    <link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="../css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="../css/animate.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="paginate/pagination.min.css">

    <link rel="stylesheet" href="paginate/bs-pagination.min.css">
    
    <script src="paginate/pagination.min.js"></script>

    <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

    <link rel="stylesheet" type="text/css" href="paginate/pagination.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.12/css/intlTelInput.css" />
    <link rel="stylesheet" href="../css/intlTelInput.css">
    <link rel='stylesheet' type="text/css" href='https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css'>
    <link rel='stylesheet' type="text/css"
        href='https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css'>
    <link rel='stylesheet' type="text/css"
        href='https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/12.1.2/css/intlTelInput.css'>
    <style type="text/css">
        .container {
            margin: 100px auto;
        }

        .box,
        .show {
            margin: 20px auto;
            text-align: center;
        }

        .show {
            padding: 10px 0;
        }
        .ibox-title1 {
  background-color: #006699;
  border-color: #0000FF;
  border-image: none;
  border-style: solid solid none;
  border-width: 1px;
  color: #FFFFFF;
  margin-bottom: 0;
  padding: 15px 90px 8px 15px;
  min-height: 48px;
  position: relative;
  clear: both;
  -webkit-border-radius: 3px 3px 0 0;
  -moz-border-radius: 3px 3px 0 0;
  border-radius: 2px 2px 0 0;
}
    </style>
</head>


<body onload="main()" >

    onload="main()"

    <div id="wrapper">
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav metismenu" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element">
                            <img alt="image" style="width: 120px;" src="../img/pizzaNpintLogo.svg" />
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="block m-t-xs font-bold" style="margin-left: 50px;"></span>
                                <!-- <span class="text-muted text-xs block">Art Director <b class="caret"></b></span> -->
                            </a>
                        </div>
                        <div class="logo-element">
                            IN+
                        </div>
                    <li>
                        <a href="/dashboard"><i class="fa fa-th-large"></i> <span
                                class="nav-label">Dashboards</span></a>

                    </li>
                    <li class='active'>

                        <a href="/user"><i class="fa fa-users"></i> <span class="nav-label">User</span></a>

                    </li>
                    <li>
                        <a href="/vendor"><i class="fa fa-user"></i> <span class="nav-label">Merchant</span></a>

                    </li>
                    <li>
                        <a href="#"><i class="fa fa-ticket"></i> <span class="nav-label">Orders</span></a>
                        <ul class="nav nav-second-level">
                            <!-- <li><a href="/orderPending">Order Pending</a></li> -->
                            <li><a href="/orderProgress">Order Inprogress</a></li>
                            <li><a href="/orderComplete">Order Completed</a></li>
                            <li><a href="/orderCancel">Order Cancelled</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="/categories"><i class="fa fa-shopping-bag"></i> <span
                                class="nav-label">Categories</span></a>

                    </li>
                    <li>
                        <a href="/offers"><i class="fa fa-percent"></i> <span class="nav-label">Offers</span></a>
                    </li>
                    <li>
                        <a href="/bannerList"><i class="fa fa-list"></i> <span class=" nav-label">All
                                Banner</span></a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-life-ring"></i> <span class="nav-labellabellabel">Notification
                            </span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="/singleNotification"> Single Notification</a></li>
                            <li><a href="/bulkNotification">Bulk Notification</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="/complaints"><i class="fa fa-comment"></i> <span
                                class="nav-label">Complaints/Reports</span></a>

                    </li>
                    <li>
                        <a href="/review"><i class="fa fa-life-ring"></i> <span class=" nav-label">All
                                Review</span></a>
                    </li>
                    <li>
                        <a href="/FAQs"><i class="fa fa-info-circle"></i> <span class="nav-label">
                                FAQs</span></a>

                    </li>

                    <li>
                        <a href="#"><i class="fa fa-cogs"></i> <span class="nav-label">Settings</span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="/app_version">App Version</a></li>
                            <li><a href="/settings">Change Password</a></li>
                        </ul>

                    </li>

                </ul>

            </div>
        </nav>
        <div id="page-wrapper" class="gray-bg">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <form role="search" class="navbar-form-custom" action="search_results.html">
                        </form>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <span class="m-r-sm text-muted welcome-message">Welcome to Eppy Admin </span>
                        </li>

                        <li><a class="dropdown-item" onclick="logout()">Logout</a></li>
                    </ul>

                </nav>
            </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-12">
                    <h2> User Detail</h2>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="/dashboard">Home</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="/user">User</a>
                        </li>
                        <li class="breadcrumb-item active">
                            <strong>User Detail </strong>
                        </li>
                    </ol>
                </div>
            </div>
            <div class="wrapper wrapper-content">
                <form id="form" method="post" enctype="test/plain" role="form">
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="ibox ">
                                <!-- <div class="img-box">
                                    <img id="blah" src="../img/previewImage.png" alt=""
                                        style="width:360px; height:250px; ">

                                </div> -->
                            </div>
                        </div>
                        <div class="col-lg-8">
                            <div class="ibox " id="ibox1">
                                <div class="ibox-content">
                                    <div class="sk-spinner sk-spinner-double-bounce">
                                        <div class="sk-double-bounce1"></div>
                                        <div class="sk-double-bounce2"></div>
                                    </div>
                                    <form id="form1" method="post" enctype="text/plain">
                                        <div class="row">
                                            <div style="margin-bottom: 15px" class="col-sm-6">
                                                <h4>Name</h4>
                                                <input type="text" name="name" id="nameValue" class="form-control"
                                                    autocomplete="off" readonly>
                                            </div>

                                            <div style="margin-bottom: 15px" class="col-sm-6">
                                                <h4>Email</h4>
                                                <input type="text" name="email" id="emailValue" class="form-control"
                                                    autocomplete="off" readonly>
                                            </div>

                                            <div style="margin-bottom: 15px" class="col-sm-6">
                                            <h4>Mobile No.</h4>
                                            <input type="mobile" id="mobileValue" name="mobile" class="form-control"
                                                readonly>
                                            </div>

                                            <!-- <div class="col-lg-6">
                                                <h4>Country Code / Phone No.</h4>
                                                <div class="row mx-0">
                                                    <div class="col-3 tell-code pl-1">
                                                        <input type="tel" id="countryCode" name="countryCode"
                                                            class="form-control mobile" placeholder="+1" readonly />
                                                    </div>
                                                    <div class="col-9 tell-num pr-1">
                                                        <input type="number" id="mobile" name="mobile"
                                                            class="form-control" placeholder="Enter  Contact Number"
                                                            readonly />
                                                    </div>
                                                </div>
                                            </div> -->

                                            <div style="margin-bottom: 15px" class="col-sm-6">
                                                <h4> Status</h4>
                                                <input type="status" id="statusValue" name="status" class="form-control"
                                                    readonly>
                                            </div>

                                        </div>

                                        <div class="col-lg-3 marginCenter">
                                            <a type="button" class="btn btn-primary w-100" id="cancel">Cancel</a>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-4 col-md-6 col-12">
                                            
                            <div class="form-group"  style="display: none;">
                                <!-- <label for="email">id</label> -->
                                <input type="text" class="form-control" 
                                   >
                            </div>
                        
                    </div>
                        <div class="col-lg-8 p-0">
                            <div class="ibox ">
                                <div class="ibox-title1">
                                    <h2><b> Orders </b></h2>

                                </div>
                                <div class="ibox-content table-responsive p-0 scrollable">
                                    <table class="table table-hover no-margins">
                                        <thead class="bg-primary p-xs b-r-sm">
                                            <tr>
                                                <th>S.No</th>
                                                <th>Booking Id</th>
                                                <th> Order Status</th>
                                                <th>Order Amount($)</th>
                                                


                                                <th>Order Date</th>
                                                <th>View</th>
                                            </tr>
                                        </thead>
                                        <tbody id='table1'>
                                        </tbody>

                                    </table>
                                   
                                </div>
                              
                            </div>
                        </div>
                       
                    </div>
                    <div class="box" id="page1">
                        <ul id="example-1" class="pagination"></ul>
                    </div>
            </div>
        </div>
        
       
        
    </div>



    <!-- Mainly scripts -->
    <script src="./js/jquery-3.1.1.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.js"></script>
    <script src="./js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="./js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Peity -->
    <script src="./js/plugins/peity/jquery.peity.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="./js/inspinia.js"></script>
    <script src="./js/plugins/pace/pace.min.js"></script>

    <!-- iCheck -->
    <script src="./js/plugins/iCheck/icheck.min.js"></script>

    <!-- Peity -->
    <script src="./js/demo/peity-demo.js"></script>
    <script type="text/javascript" src="../paginate/pagination.min.js"></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js'></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/12.1.2/js/intlTelInput.js'></script>
    <script>
        var host = window.location.protocol + "//" + window.location.host;
        var token = localStorage.getItem("token")
        if (!token) {
            localStorage.removeItem("name");
            localStorage.removeItem("token");
            // window.location.replace('/login');
        }

        function auth(code) {
            if (code == 403) {
                localStorage.removeItem("name");
                localStorage.removeItem("token");
                // window.location.replace('/login');
            }
        }

        function logout() {

            $.ajax({
                url: host + '/api/v1/admin/logout',
                type: 'Get',
                // data: formData,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('x-auth', token);
                },
                contentType: false,
                processData: false,
                success: function (data) {
                    auth(data.code)
                    localStorage.removeItem("name");
                    localStorage.removeItem("token");
                    window.location.replace('/login');
                }
            })
        }


        // function mobileNoselect() {
        //         let x = document.forms["form"]["countryCode"].value;
        //     if ($('#form').length) {
        //         $(".mobile").intlTelInput();
        //         $(".mobile").intlTelInput("setNumber", x);

        //     };
        //  };

        // setTimeout(mobileNoselect, 500);
        // //* Select js
        // function nice_Select() {
        //     if ($('.product_select').length) {
        //         $('select').niceSelect();
        //     };
        // };
        // // Function Calls* 
        // // verificationForm ();

        function main(){
        //   mobileNoselect();
        //   nice_Select();
          details();
        }


        $(document).ready(function () {
            $("#form1").submit(function (e) {
                e.preventDefault();
                var formData = new FormData(this);
                $.ajax({
                    url: host + '/api/v1/user/editbyadmin',
                    type: 'post',
                    data: formData,
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader('x-auth', token);
                    },
                    contentType: false,
                    processData: false,
                    success: function (data) {

                        auth(data.code)
                        if (data.code == 200) {
                            window.location.replace('/user')
                        } else {

                            alert(data.message);
                        }
                    },
                });
            });
        });


        function details(){
            var currentLocation = window.location.href;
            var url = new URL(currentLocation);
            console.log(url)
   

        var id = url.searchParams.get("id");
        console.log(id)

  
        
        var obj = {
            "user_id": id
         }


        $.ajax({
            url: host + '/api/v1/admin/userProfiledetails',
            type: 'get',
            contentType: 'application/json',
            data: obj,
            // beforeSend: function(xhr) {
            //     xhr.setRequestHeader('x-auth', token);
            // },
            dataType: 'json',
            success: function (data) {
                console.log(data)
                auth(data.code)
               
                    if (data.isActive == true) {
                        var x = 'Active'
                    } else {
                        var x = 'Deactive'
                    }
                    var arr = []
                    document.getElementById('nameValue').value = data.fullName ? data.fullName : 'N/A';
                    document.getElementById('mobileValue').value = data.mobile ? data.mobile : 0;
                    document.getElementById('emailValue').value = data.email ? data.email : 'N/A';
                    // document.getElementById('countryCode').value = data.result.countryCode,
                        //document.getElementById('role').value = data.result.role ? data.result.role : 'N/A';
                        //  document.getElementById('address').value = data.result.address ? data.result.address : 'N/A';
                        document.getElementById('statusValue').value = x ? x : 'N/A';
                    // document.getElementById('registrationNo').value = data.result.user_data.registrationNo ? data.result.user_data.registrationNo : 'N/A';
                    // document.getElementById('complete').innerHTML = 'Completed Bookings' + ' ' + '(' + data.result.completeCount + ')';
                    //.getElementById('ongo').innerHTML = 'Ongoing Bookings' + ' ' + '(' + data.result.ongoingCount + ')';
                    // document.getElementById('cancel').innerHTML = 'Cancelled Bookings' + ' ' + '(' + data.result.cancelCount + ')';

                    // document.getElementById('blah').src = data.result.profileImg ? data.result.profileImg : "../img/previewImage.png"
                
                }
            })
        }

// $.ajax({
//     url: host + '/api/v1/admin/userorderDetails',
//     type: 'Post',
//     contentType: 'application/json',
//     data: JSON.stringify(obj1),
//     // beforeSend: function (xhr) {
//     //     xhr.setRequestHeader('x-auth', token);
//     // },
//     dataType: 'json',

//     success: function (data, status) {
//         auth(data.code)
//         if (data.code == 200) {
//             $("#loader1").hide("loader")
//         }
//         if (data.code == 200 && data.result.length != 0) {
//             $("#table2").removeClass("hide")
//             $("#noData").removeClass("show")
//             $("#page1").removeClass("hide")

//             var x = data.Total
//             $('#example-1').pagination({
//                 total: x,
//                 current: 1,
//                 length: 10,
//                 prev: 'Previous',
//                 next: 'Next',
//                 click: function (options, $target) {
//                     let obj = {
//                         'pageNo': options.current,
//                         'perPage': options.length,                     
//                     }
//                     $.ajax({
//                         url: host + '/api/v1/admin/userorderDetails',
//                         type: 'Post',
//                         contentType: 'application/json',
//                         data: JSON.stringify(obj1),
//                         // beforeSend: function (xhr) {
//                         //     xhr.setRequestHeader('x-auth', token);
//                         // },
//                         dataType: 'json',
//                         success: function (data, Status) {
//                             auth(data.code)
//                             if (data.code == 200 && data.result.length != 0) {
//                                 $("#table1").html(' ');
//                                 for (var i = 0; i < data.result.length; i++) {
//                                     var index = i + 1;
//                         if (data.result[i].order_Date) {
//                              var date = formatDate(data.result[i].order_Date)
//                          } else {
//                             var date = "-"
//                         }
//                          var num = new Number(data.result[i].grand_total);
//                          var todecimal = num.toPrecision(4)

//                         document.getElementById('table1').innerHTML += '<tr>' +
//                             '<td >' + index + '<td >' + data.result[i].orderId + '<td >' + data.result[i].status + '<td >' + '$' + todecimal + '<td >' + date +

//                        '<td><button type="button" class="btn btn-sm btn-success" id="Action_button" data-target="' + 'View' + '"onclick= "View(' + '\'' + data.result[i]._id + '\'' + ')">' + 'View' + '</button></tr>'

                              
//                                 }
//                             }

//                         }

//                     })
//                     $target.next(".show").text('Current: ' + options.current);

//                 }
//             })
//             $("#table").html(' ');
//             for (var i = 0; i < data.result.length; i++) {
//                 var index = i + 1;
//                         if (data.result[i].order_Date) {
//                             var date = formatDate(data.result[i].order_Date)
//                          } else {
//                             var date = "-"
//                         }
//                         var num = new Number(data.result[i].grand_total);
//                         var todecimal = num.toPrecision(4)

//                         document.getElementById('table1').innerHTML += '<tr>' +
//                              '<td >' + index + '<td >' + data.result[i].orderId + '<td >' + data.result[i].status + '<td >' + '$' + todecimal + '<td >' + date +

//                         '<td><button type="button" class="btn btn-sm btn-success" id="Action_button" data-target="' + 'View' + '"onclick= "View(' + '\'' + data.result[i]._id + '\'' + ')">' + 'View' + '</button></tr>'

                    
//             }
//         } else {
//             $("#table").html(' ');
//             $("#table2").addClass("hide");
//             $("#noData").addClass("show");
//             $("#page1").hide();

//         }
//     }

// });


        // $.ajax({
        //     url: host + '/api/v1/admin/userorderDetails',
        //     type: 'Post',
           
        //     data: JSON.stringify(obj),
        //     contentType: 'application/json',
        //     beforeSend: function (xhr) {
        //         xhr.setRequestHeader('x-auth', token);
        //     },
        //     dataType: 'json',
        //     success: function (data) {
        //         auth(data.code)
        //         if (data.code == 200) {
        //             for (var i = 0; i < data.result.length; i++) {
        //                 var index = i + 1;
        //                 if (data.result[i].order_Date) {
        //                     var date = formatDate(data.result[i].order_Date)
        //                 } else {
        //                     var date = "-"
        //                 }
        //                 var num = new Number(data.result[i].grand_total);
        //                 var todecimal = num.toPrecision(4)

        //                 document.getElementById('table1').innerHTML += '<tr>' +
        //                     '<td >' + index + '<td >' + data.result[i].orderId + '<td >' + data.result[i].status + '<td >' + '$' + todecimal + '<td >' + date +

        //                 '<td><button type="button" class="btn btn-sm btn-success" id="Action_button" data-target="' + 'View' + '"onclick= "View(' + '\'' + data.result[i]._id + '\'' + ')">' + 'View' + '</button></tr>'

        //                 // + '<td >' + data.Applied[i].salesId.totalProposal
        //                 //'</tr>'

        //             }

        //         } else {
        //             swal({
        //                 title: "Error",
        //                 text: data.message
        //             });
        //         }
        //     }
        // })


        
        // $.ajax({
        //     url: host + '/api/v1/user/getUserDetailForAdmin',
        //     type: 'Post',
        //     data: JSON.stringify(obj),
        //     contentType: 'application/json',
        //     beforeSend: function(xhr) {
        //         xhr.setRequestHeader('x-auth', token);
        //     },
        //     dataType: 'json',
        //     success: function(data) {
        //         auth(data.code)
        //         if (data.code == 200) {
        //             console.log(data.result.pending.length, "cdcd")
        //             for (var i = 0; i < data.result.pending.length; i++) {
        //                 var index = i + 1;
        //                 document.getElementById('table2').innerHTML += '<tr >' +
        //                     '<td >' + index + '<td >' + data.result.pending[i].orderId + '<td >' + data.result.pending[i].salonId.name + '<td>' + data.result.pending[i].salonId.mobileNo +
        //                     //  '<td >' + data.result.pending[i].userId.name ++ '<td >' + data.Applied[i].salesId.totalProposal
        //                     '<td><button type="button" class="btn btn-sm btn-success" id="Action_button" data-target="' + 'View' + '"onclick= "View(' + '\'' + data.result.pending[i]._id + '\'' + ')">' + 'View' + '</button></tr>'

        //                 //         '</tr>'
        //             }

        //         } else {
        //             swal({
        //                 title: "Error",
        //                 text: data.message
        //             });
        //         }
        //     }
        // })
        // $.ajax({
        //     url: host + '/api/v1/user/getUserDetailForAdmin',
        //     type: 'Post',
        //     data: JSON.stringify(obj),
        //     contentType: 'application/json',
        //     beforeSend: function(xhr) {
        //         xhr.setRequestHeader('x-auth', token);
        //     },
        //     dataType: 'json',
        //     success: function(data) {
        //         auth(data.code)
        //         if (data.code == 200) {
        //             // console.log(data.,"cdcd")
        //             for (var i = 0; i < data.result.cancelled.length; i++) {
        //                 var index = i + 1;
        //                 document.getElementById('table3').innerHTML += '<tr >' +
        //                     '<td >' + index + '<td >' + data.result.cancelled[i].orderId + '<td >' + data.result.cancelled[i].salonId.name + '<td>' + data.result.cancelled[i].salonId.mobileNo +
        //                     '<td><button type="button" class="btn btn-sm btn-success" id="Action_button" data-target="' + 'View' + '"onclick= "View(' + '\'' + data.result.cancelled[i]._id + '\'' + ')">' + 'View' + '</button></tr>'

        //                 // '</tr>'

        //             }

        //         } else {
        //             swal({
        //                 title: "Error",
        //                 text: data.message
        //             });
        //         }
        //     }
        // })
        $("#cancel").click(function (user_id) {

            var id = user_id
            // window.location.href = host + "/user"
            window.history.back()
        })
        function View(user_id) {
            var x = user_id;
            window.location.href = "/orderDetails?id=" + x
        }

        function formatDate(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();
            const monthNames = ["Jan", "Feb", "March", "April", "May", "June",
                "July", "Aug", "Sept", "Oct", "Nov", "Dec"
            ];
            if (month.length < 2)
                month = '0' + month;
            if (day.length < 2)
                day = '0' + day;
            var y = monthNames[month - 1]
            return [day, monthNames[month - 1], year].join('-');
        }
    </script>

</body>

</html>